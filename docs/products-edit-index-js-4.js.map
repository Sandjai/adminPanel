{"version":3,"sources":["webpack:///./src/utils/escape-html.js","webpack:///./src/components/product-form/index.js","webpack:///./src/pages/products/edit/index.js","webpack:///./src/utils/fetch-json.js","webpack:///./src/components/notification/index.js","webpack:///./src/components/sortable-list/index.js","webpack:///./node_modules/uuid/lib/rng-browser.js","webpack:///./node_modules/uuid/lib/bytesToUuid.js","webpack:///./node_modules/uuid/index.js","webpack:///./node_modules/uuid/v1.js","webpack:///./node_modules/uuid/v4.js"],"names":["string","replace","v4","uuidv4","require","ProductForm","constructor","productId","title","description","quantity","subcategory","status","images","price","discount","event","preventDefault","this","save","fileInput","document","createElement","type","accept","addEventListener","async","file","files","formData","FormData","uploadImage","imageListContainer","subElements","append","classList","add","disabled","result","fetchJson","method","headers","Authorization","body","getImageItem","data","link","name","remove","hidden","appendChild","click","template","createCategoriesSelect","defaultFormData","categoriesPromise","loadCategoriesList","productPromise","loadProductData","Promise","resolve","categoriesData","productResponse","all","productData","categories","renderForm","setFormData","createImagesList","initEventListeners","element","innerHTML","getEmptyTemplate","firstElementChild","getSubElements","showNotificationMessage","messageText","messageType","NotificationMessage","duration","show","product","getFormData","JSON","stringify","dispatchEvent","id","error","console","productForm","excludedFields","formatToNumber","fields","Object","keys","filter","item","includes","values","field","parseInt","querySelector","value","imagesHTMLCollection","querySelectorAll","image","push","url","src","source","alt","CustomEvent","detail","forEach","wrapper","select","category","child","subcategories","Option","outerHTML","elements","dataset","items","map","sortableList","SortableList","escapeHtml","onSubmit","destroy","Page","initComponents","renderComponents","components","productFrom","render","component","params","response","fetch","toString","err","FetchError","ok","errorText","statusText","json","message","Error","super","window","reason","alert","el","firstChild","parent","shownEl","clearTimeout","timerId","setTimeout","clientX","clientY","moveDraggingAt","children","top","firstElementTop","getBoundingClientRect","bottom","movePlaceholderAt","length","i","li","draggingElem","offsetHeight","height","scrollIfCloseToWindowEdge","dragStop","className","addItems","onPointerDown","which","itemElem","target","closest","dragStart","elementInitialIndex","indexOf","pointerInitialShift","x","y","placeholderElem","style","width","offsetWidth","after","onDocumentPointerMove","onDocumentPointerUp","left","scrollBy","documentElement","clientHeight","index","currentElement","insertBefore","placeholderIndex","replaceWith","removeEventListener","bubbles","details","from","to","getRandomValues","crypto","bind","msCrypto","rnds8","Uint8Array","module","exports","rnds","Array","r","Math","random","byteToHex","substr","buf","offset","bth","join","v1","uuid","_nodeId","_clockseq","rng","bytesToUuid","_lastMSecs","_lastNSecs","options","b","node","clockseq","undefined","seedBytes","msecs","Date","getTime","nsecs","dt","tl","tmh","n","ii"],"mappings":"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","file":"products-edit-index-js-4.js","sourcesContent":["export default string => string\n  .replace(/&/g, '&amp;')\n  .replace(/\"/g, '&quot;')\n  .replace(/'/g, '&#39;')\n  .replace(/</g, '&lt;')\n  .replace(/>/g, '&gt;');\n","import SortableList from '../sortable-list/index.js';\nimport escapeHtml from '../../utils/escape-html.js';\nimport fetchJson from '../../utils/fetch-json.js';\nimport NotificationMessage from './../notification/index.js';\nconst { v4: uuidv4 } = require('uuid');\n\n\n\nexport default class ProductForm {\n  element;\n  subElements = {};\n  defaultFormData = {\n    title: '',\n    description: '',\n    quantity: 1,\n    subcategory: '',\n    status: 1,\n    images: [],\n    price: 100,\n    discount: 0\n  };\n\n    constructor(productId) {\n    this.productId = productId;\n  }\n\n  onSubmit = event => {\n    event.preventDefault();\n\n    this.save();\n  };\n\n  uploadImage = () => {\n    const fileInput = document.createElement('input');\n    fileInput.type = 'file';\n    fileInput.accept = 'image/*';\n\n    fileInput.addEventListener('change', async () => {\n      const [file] = fileInput.files;\n\n      if (file) {\n        const formData = new FormData();\n        const { uploadImage, imageListContainer } = this.subElements;\n\n        formData.append('image', file);\n        uploadImage.classList.add('is-loading');\n        uploadImage.disabled = true;\n\n        const result = await fetchJson('https://api.imgur.com/3/image', {\n          method: 'POST',\n          headers: {\n            Authorization: `Client-ID ${process.env.IMGUR_CLIENT_ID}`\n          },\n          body: formData\n        });\n\n        imageListContainer.append(this.getImageItem(result.data.link, file.name));\n        uploadImage.classList.remove('is-loading');\n        uploadImage.disabled = false;\n\n        // Remove input from body\n        fileInput.remove();\n      }\n    });\n\n    fileInput.hidden = true;\n    document.body.appendChild(fileInput);\n    fileInput.click();\n  };\n\n\n\n  template() {\n    return `\n      <div class=\"product-form\">\n\n      <form data-element=\"productForm\" class=\"form-grid\">\n        <div class=\"form-group form-group__half_left\">\n          <fieldset>\n            <label class=\"form-label\">Название товара</label>\n            <input required\n              id=\"title\"\n              value=\"\"\n              type=\"text\"\n              name=\"title\"\n              class=\"form-control\"\n              placeholder=\"Название товара\">\n          </fieldset>\n        </div>\n\n        <div class=\"form-group form-group__wide\">\n          <label class=\"form-label\">Описание</label>\n          <textarea required\n            id=\"description\"\n            class=\"form-control\"\n            name=\"description\"\n            placeholder=\"Описание товара\"></textarea>\n        </div>\n\n        <div class=\"form-group form-group__wide\">\n          <label class=\"form-label\">Фото</label>\n\n          <div data-element=\"imageListContainer\"></div>\n\n          <button data-element=\"uploadImage\" type=\"button\" class=\"button-primary-outline\">\n            <span>Загрузить</span>\n          </button>\n        </div>\n\n        <div class=\"form-group form-group__half_left\">\n          <label class=\"form-label\">Категория</label>\n            ${this.createCategoriesSelect()}\n        </div>\n\n        <div class=\"form-group form-group__half_left form-group__two-col\">\n          <fieldset>\n            <label class=\"form-label\">Цена ($)</label>\n            <input required\n              id=\"price\"\n              value=\"\"\n              type=\"number\"\n              name=\"price\"\n              class=\"form-control\"\n              placeholder=\"${this.defaultFormData.price}\">\n          </fieldset>\n          <fieldset>\n            <label class=\"form-label\">Скидка ($)</label>\n            <input required\n              id=\"discount\"\n              value=\"\"\n              type=\"number\"\n              name=\"discount\"\n              class=\"form-control\"\n              placeholder=\"${this.defaultFormData.discount}\">\n          </fieldset>\n        </div>\n\n        <div class=\"form-group form-group__part-half\">\n          <label class=\"form-label\">Количество</label>\n          <input required\n            id=\"quantity\"\n            value=\"\"\n            type=\"number\"\n            class=\"form-control\"\n            name=\"quantity\"\n            placeholder=\"${this.defaultFormData.quantity}\">\n        </div>\n\n        <div class=\"form-group form-group__part-half\">\n          <label class=\"form-label\">Статус</label>\n          <select id=\"status\" class=\"form-control\" name=\"status\">\n            <option value=\"1\">Активен</option>\n            <option value=\"0\">Неактивен</option>\n          </select>\n        </div>\n\n        <div class=\"form-buttons\">\n          <button type=\"submit\" name=\"save\" class=\"button-primary-outline\">\n            ${this.productId ? 'Сохранить' : 'Добавить'} товар\n          </button>\n        </div>\n      </form>\n    </div>\n    `;\n  }\n\n  async render() {\n    const categoriesPromise = this.loadCategoriesList();\n    const productPromise = this.productId\n      ? this.loadProductData(this.productId)\n      : Promise.resolve([this.defaultFormData]);\n\n    const [categoriesData, productResponse] = await Promise.all([categoriesPromise, productPromise]);\n    const [productData] = productResponse;\n\n    this.formData = productData;\n    this.categories = categoriesData;\n\n    this.renderForm();\n    this.setFormData();\n    this.createImagesList();\n    this.initEventListeners();\n\n    return this.element;\n  }\n\n  renderForm() {\n    const element = document.createElement('div');\n\n    element.innerHTML = this.formData\n      ? this.template()\n      : this.getEmptyTemplate();\n\n    this.element = element.firstElementChild;\n    this.subElements = this.getSubElements(element);\n  }\n\n  getEmptyTemplate() {\n    return `<div>\n      <h1 class=\"page-title\">Страница не найдена</h1>\n      <p>Извините, данный товар не существует</p>\n    </div>`;\n  }\n\n  showNotificationMessage(messageText, messageType) {\n\n    const notificationMessage = new NotificationMessage(messageText, {\n      duration: 2000,\n      type: messageType\n    });\n\n    notificationMessage.show();\n  }\n  \n\n  async save() {\n    const product = this.getFormData();\n\n    try {\n    const result = await fetchJson(`${process.env.BACKEND_URL}api/rest/products`, {\n      method: this.productId ? 'PATCH' : 'PUT',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(product)\n    });\n\n    this.productId\n        ? this.showNotificationMessage('Продукт обновлён', 'success')\n        : this.showNotificationMessage('Продукт сохранён', 'success');\n        \n        this.dispatchEvent(result.id);\n  } catch(error) {\n    this.showNotificationMessage('OOPS! Something went wrong', 'error');\n    console.error('something went wrong', error);\n  }\n}\n\n  getFormData() {\n    const {productForm, imageListContainer} = this.subElements;\n    const excludedFields = ['images'];\n    const formatToNumber = ['price', 'quantity', 'discount', 'status'];\n    const fields = Object.keys(this.defaultFormData).filter(item => !excludedFields.includes(item));\n    const values = {};\n\n    for (const field of fields) {\n      values[field] = formatToNumber.includes(field)\n        ? parseInt(productForm.querySelector(`#${field}`).value)\n        : productForm.querySelector(`#${field}`).value;\n    }\n\n    const imagesHTMLCollection = imageListContainer.querySelectorAll('.sortable-table__cell-img');\n\n    values.images = [];\n    values.id = this.productId;\n\n    if(!this.productId) {\n      values.id = uuidv4();\n    }\n\n    for (const image of imagesHTMLCollection) {\n      values.images.push({\n        url: image.src,\n        source: image.alt\n      });\n    }\n\n    return values;\n  }\n\n  dispatchEvent(id) {\n    const event = this.productId\n      ? new CustomEvent('product-updated', {detail: id})\n      : new CustomEvent('product-saved');\n\n    this.element.dispatchEvent(event);\n  }\n\n  setFormData() {\n    const {productForm} = this.subElements;\n    const excludedFields = ['images'];\n    const fields = Object.keys(this.defaultFormData).filter(item => !excludedFields.includes(item));\n\n    fields.forEach(item => {\n      const element = productForm.querySelector(`#${item}`);\n\n      element.value = this.formData[item] || this.defaultFormData[item];\n    });\n  }\n\n  async loadProductData(productId) {\n    return await fetchJson(`${process.env.BACKEND_URL}api/rest/products?id=${productId}`);\n  }\n\n  async loadCategoriesList() {\n    return await fetchJson(`${process.env.BACKEND_URL}api/rest/categories?_sort=weight&_refs=subcategory`);\n  }\n\n  createCategoriesSelect() {\n    const wrapper = document.createElement('div');\n\n    wrapper.innerHTML = '<select class=\"form-control\" id=\"subcategory\" name=\"subcategory\"></select>';\n\n    const select = wrapper.firstElementChild;\n\n    for (const category of this.categories) {\n      for (const child of category.subcategories) {\n        select.append(new Option(`${category.title} > ${child.title}`, child.id));\n      }\n    }\n\n    return select.outerHTML;\n  }\n\n  getSubElements(element) {\n    const subElements = {};\n    const elements = element.querySelectorAll('[data-element]');\n\n    for (const item of elements) {\n      subElements[item.dataset.element] = item;\n    }\n\n    return subElements;\n  }\n\n  createImagesList() {\n    const { imageListContainer } = this.subElements;\n    const { images } = this.formData;\n    const items = images.map(image => this.getImageItem(image.url, image.source));\n    const sortableList = new SortableList({ items });\n    imageListContainer.append(sortableList.element);\n  }\n\n  getImageItem(url, name) {\n    const wrapper = document.createElement('div');\n    wrapper.innerHTML = `          \n        <li class=\"products-edit__imagelist-item sortable-list__item\" style=\"\">\n          <span>\n            <img src=\"/icon-grab.svg\" data-grab-handle=\"\" alt=\"grab\">\n            <img class=\"sortable-table__cell-img\" alt=\"${escapeHtml(name)}\" src=\"${escapeHtml(\n      url\n    )}\">\n            <span>${escapeHtml(name)}</span>\n          </span>\n          <button type=\"button\">\n            <img src=\"/icon-trash.svg\" data-delete-handle=\"\" alt=\"delete\">\n          </button>\n        </li>`;\n\n    return wrapper.firstElementChild;\n  }\n\n  initEventListeners() {\n    const {uploadImage, productForm, imageListContainer} = this.subElements;\n\n    productForm.addEventListener('submit', this.onSubmit);\n    uploadImage.addEventListener('pointerdown', this.uploadImage);\n  }\n\n  destroy() {\n    this.remove();\n    this.element = null;\n    this.subElements = null;\n  }\n\n  remove() {\n    this.element.remove();\n  }\n}\n","import ProductForm from \"../../../components/product-form\";\n\nexport default class Page {\n  element;\n  subElements = {};\n  components = {};  \n\n  constructor(productId = null) {\n    this.productId = productId;\n  }\n\n  async render() {\n    const element = document.createElement('div');\n\n    element.innerHTML = `\n      <div>\n        <h1>${this.productId != null ? 'Редактирование товара' : 'Новый товар'}</h1>\n      </div>`;\n\n    this.element = element.firstElementChild;\n\n    this.initComponents();\n    await this.renderComponents();\n\n    return this.element;\n  }\n\n  initComponents() {\n    \n\n    this.components.productFrom = new ProductForm(this.productId);\n  }\n\n  async renderComponents() {\n    const element = await this.components.productFrom.render();\n\n    this.element.append(element);\n  }\n\n  destroy() {\n    for (const component of Object.values(this.components)) {\n      component.destroy();\n    }\n  }\n}\n","// same as fetch, but throws FetchError in case of errors\n// status >= 400 is an error\n// network error / json error are errors\n\nexport default async function(url, params) {\n  let response;\n\n  try {\n    // NOTE: \"toString\" call needed for correct work of \"jest-fetch-mock\"\n    response = await fetch(url.toString(), params);\n  } catch(err) {\n    throw new FetchError(response, \"Network error has occurred.\");\n  }\n\n  let body;\n\n  if (!response.ok) {\n    let errorText = response.statusText; // Not Found (for 404)\n\n    try {\n      body = await response.json();\n\n      errorText = (body.error && body.error.message) || (body.data && body.data.error && body.data.error.message) || errorText;\n    } catch (error) { /* ignore failed body */ }\n\n    let message = `Error ${response.status}: ${errorText}`;\n\n    throw new FetchError(response, body, message);\n  }\n\n  try {\n    return await response.json();\n  } catch(err) {\n    throw new FetchError(response, null, err.message);\n  }\n}\n\nexport class FetchError extends Error {\n  name = \"FetchError\";\n\n  constructor(response, body, message) {\n    super(message);\n    this.response = response;\n    this.body = body;\n  }\n}\n\n// handle uncaught failed fetch through\nwindow.addEventListener('unhandledrejection', event => {\n  if (event.reason instanceof FetchError) {\n    alert(event.reason.message);\n  }\n});\n\n","export default class NotificationMessage {\r\n\r\n    static shownEl;  \r\n    timerId;\r\n\r\n    constructor(\r\n        message = '', {\r\n        duration = 0,\r\n        type = ''\r\n      } = {}) {\r\n\r\n        this.message = message;\r\n        this.duration = duration;\r\n        this.type = type;\r\n        \r\n        this.render();\r\n    }    \r\n    \r\n    get template () {\r\n        return `<div class=\"notification ${this.type}\" style=\"--value:${this.duration/1000}s\">\r\n                    <div class=\"timer\"></div>\r\n                    <div class=\"inner-wrapper\">\r\n                    <div class=\"notification-header\">${(this.type === 'success') ? \"Успех!\" : \"Ошибка\"}</div>\r\n                    <div class=\"notification-body\">\r\n                        ${this.message}\r\n                    </div>\r\n                    </div>\r\n                </div>`\r\n    }\r\n\r\n    render() {\r\n        const el = document.createElement('div');\r\n        el.innerHTML = this.template;\r\n       \r\n        this.element = el.firstChild;\r\n    }\r\n\r\n    show(parent = document.body) {        \r\n            if (NotificationMessage.shownEl) {\r\n                NotificationMessage.shownEl.remove();\r\n                clearTimeout(this.timerId);\r\n            }\r\n            \r\n            parent.append(this.element);\r\n            NotificationMessage.shownEl = this;\r\n            this.timerId = setTimeout(() => {this.destroy()}, `${this.duration}`);\r\n            \r\n\r\n        }\r\n\r\n    remove() {\r\n        if (this.element) {\r\n        this.element.remove();\r\n        }\r\n    }\r\n\r\n    destroy() {       \r\n        this.remove();\r\n        this.element = null;\r\n    }\r\n\r\n}\r\n","export default class SortableList {\n  element;\n\n  onDocumentPointerMove = ({clientX, clientY}) => {\n    this.moveDraggingAt(clientX, clientY);\n\n    const {firstElementChild, children} = this.element;\n    const {top: firstElementTop} = firstElementChild.getBoundingClientRect();\n    const {bottom} = this.element.getBoundingClientRect();\n\n    if (clientY < firstElementTop) {\n      this.movePlaceholderAt(0);\n    } else if (clientY > bottom) {\n      this.movePlaceholderAt(children.length);\n    } else {\n      for (let i = 0; i < children.length; i++) {\n        const li = children[i];\n\n        // ignore to prevent bugs when dragging between elements\n        if (li !== this.draggingElem) {\n          const {top, bottom} = li.getBoundingClientRect();\n          const {offsetHeight: height} = li;\n\n          if (clientY > top && clientY < bottom) {\n            // inside the element (y-axis)\n            if (clientY < top + height / 2) {\n              // upper half of the element\n              this.movePlaceholderAt(i);\n              break;\n            } else {\n              // lower half of the element\n              this.movePlaceholderAt(i + 1);\n              break;\n            }\n          }\n        }\n      }\n    }\n\n    this.scrollIfCloseToWindowEdge(clientY);\n  };\n\n  onDocumentPointerUp = () => {\n    this.dragStop();\n  };\n\n  constructor({items = []} = {}) {\n    this.items = items;\n\n    this.render();\n  }\n\n  render() {\n    this.element = document.createElement('ul');\n    this.element.className = 'sortable-list';\n\n    this.addItems();\n    this.initEventListeners();\n  }\n\n  initEventListeners() {\n    this.element.addEventListener('pointerdown', event => this.onPointerDown(event));\n  }\n\n  addItems() {\n    // item is a DOM element\n    for (let item of this.items) {\n      item.classList.add('sortable-list__item');\n    }\n\n    this.element.append(...this.items);\n  }\n\n  onPointerDown(event) {\n    if (event.which !== 1) { // must be left-button\n      return false;\n    }\n\n    const itemElem = event.target.closest('.sortable-list__item');\n\n    if (itemElem) {\n      if (event.target.closest('[data-grab-handle]')) {\n        event.preventDefault();\n\n        this.dragStart(itemElem, event);\n      }\n\n      if (event.target.closest('[data-delete-handle]')) {\n        event.preventDefault();\n\n        itemElem.remove();\n      }\n    }\n  }\n\n  dragStart(itemElem, {clientX, clientY}) {\n    this.elementInitialIndex = [...this.element.children].indexOf(itemElem);\n\n    this.pointerInitialShift = {\n      x: clientX - itemElem.getBoundingClientRect().x,\n      y: clientY - itemElem.getBoundingClientRect().y\n    };\n\n    this.draggingElem = itemElem;\n\n    this.placeholderElem = document.createElement('li');\n    this.placeholderElem.className = 'sortable-list__placeholder';\n\n    // itemElem will get position:fixed\n    // so its width will be auto-set to fit the parent container\n    itemElem.style.width = `${itemElem.offsetWidth}px`;\n    itemElem.style.height = `${itemElem.offsetHeight}px`;\n\n    this.placeholderElem.style.width = itemElem.style.width;\n    this.placeholderElem.style.height = itemElem.style.height;\n\n    itemElem.classList.add('sortable-list__item_dragging');\n\n    itemElem.after(this.placeholderElem);\n\n    // move to the end, to be over other list elements\n    this.element.append(itemElem);\n\n    this.moveDraggingAt(clientX, clientY);\n\n    document.addEventListener('pointermove', this.onDocumentPointerMove);\n    document.addEventListener('pointerup', this.onDocumentPointerUp);\n  }\n\n  moveDraggingAt(clientX, clientY) {\n    this.draggingElem.style.left = clientX - this.pointerInitialShift.x + 'px';\n    this.draggingElem.style.top = clientY - this.pointerInitialShift.y + 'px';\n  }\n\n  scrollIfCloseToWindowEdge(clientY) {\n    const scrollingValue = 10;\n    const threshold = 20;\n\n    if (clientY < threshold) {\n      window.scrollBy(0, -scrollingValue);\n    } else if (clientY > document.documentElement.clientHeight - threshold) {\n      window.scrollBy(0, scrollingValue);\n    }\n  }\n\n  movePlaceholderAt(index) {\n    const currentElement = this.element.children[index];\n\n    if (currentElement !== this.placeholderElem) {\n      this.element.insertBefore(this.placeholderElem, currentElement);\n    }\n  }\n\n  dragStop() {\n    const placeholderIndex = [...this.element.children].indexOf(this.placeholderElem);\n\n    // drop element back\n    this.placeholderElem.replaceWith(this.draggingElem);\n    this.draggingElem.classList.remove('sortable-list__item_dragging');\n\n    this.draggingElem.style.left = '';\n    this.draggingElem.style.top = '';\n    this.draggingElem.style.width = '';\n    this.draggingElem.style.height = '';\n\n    document.removeEventListener('pointermove', this.onDocumentPointerMove);\n    document.removeEventListener('pointerup', this.onDocumentPointerUp);\n\n    this.draggingElem = null;\n\n    if (placeholderIndex !== this.elementInitialIndex) {\n      this.element.dispatchEvent(new CustomEvent('sortable-list-reorder', {\n        bubbles: true,\n        details: {\n          from: this.elementInitialIndex,\n          to: placeholderIndex\n        }\n      }));\n    }\n  }\n\n  remove() {\n    this.element.remove();\n    document.removeEventListener('pointermove', this.onDocumentPointerMove);\n    document.removeEventListener('pointerup', this.onDocumentPointerUp);\n  }\n\n  destroy() {\n    this.remove();\n  }\n}\n","// Unique ID creation requires a high quality random # generator.  In the\n// browser this is a little complicated due to unknown quality of Math.random()\n// and inconsistent support for the `crypto` API.  We do the best we can via\n// feature-detection\n\n// getRandomValues needs to be invoked in a context where \"this\" is a Crypto\n// implementation. Also, find the complete implementation of crypto on IE11.\nvar getRandomValues = (typeof(crypto) != 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto)) ||\n                      (typeof(msCrypto) != 'undefined' && typeof window.msCrypto.getRandomValues == 'function' && msCrypto.getRandomValues.bind(msCrypto));\n\nif (getRandomValues) {\n  // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto\n  var rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n\n  module.exports = function whatwgRNG() {\n    getRandomValues(rnds8);\n    return rnds8;\n  };\n} else {\n  // Math.random()-based (RNG)\n  //\n  // If all else fails, use Math.random().  It's fast, but is of unspecified\n  // quality.\n  var rnds = new Array(16);\n\n  module.exports = function mathRNG() {\n    for (var i = 0, r; i < 16; i++) {\n      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n      rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n    }\n\n    return rnds;\n  };\n}\n","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex;\n  // join used to fix memory issue caused by concatenation: https://bugs.chromium.org/p/v8/issues/detail?id=3175#c4\n  return ([\n    bth[buf[i++]], bth[buf[i++]],\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]], '-',\n    bth[buf[i++]], bth[buf[i++]],\n    bth[buf[i++]], bth[buf[i++]],\n    bth[buf[i++]], bth[buf[i++]]\n  ]).join('');\n}\n\nmodule.exports = bytesToUuid;\n","var v1 = require('./v1');\nvar v4 = require('./v4');\n\nvar uuid = v4;\nuuid.v1 = v1;\nuuid.v4 = v4;\n\nmodule.exports = uuid;\n","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\n// **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\nvar _nodeId;\nvar _clockseq;\n\n// Previous uuid creation time\nvar _lastMSecs = 0;\nvar _lastNSecs = 0;\n\n// See https://github.com/uuidjs/uuid for API details\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || [];\n\n  options = options || {};\n  var node = options.node || _nodeId;\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq;\n\n  // node and clockseq need to be initialized to random values if they're not\n  // specified.  We do this lazily to minimize issues related to insufficient\n  // system entropy.  See #189\n  if (node == null || clockseq == null) {\n    var seedBytes = rng();\n    if (node == null) {\n      // Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\n      node = _nodeId = [\n        seedBytes[0] | 0x01,\n        seedBytes[1], seedBytes[2], seedBytes[3], seedBytes[4], seedBytes[5]\n      ];\n    }\n    if (clockseq == null) {\n      // Per 4.2.2, randomize (14 bit) clockseq\n      clockseq = _clockseq = (seedBytes[6] << 8 | seedBytes[7]) & 0x3fff;\n    }\n  }\n\n  // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n  var msecs = options.msecs !== undefined ? options.msecs : new Date().getTime();\n\n  // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1;\n\n  // Time since last uuid creation (in msecs)\n  var dt = (msecs - _lastMSecs) + (nsecs - _lastNSecs)/10000;\n\n  // Per 4.2.1.2, Bump clockseq on clock regression\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  }\n\n  // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  }\n\n  // Per 4.2.1.2 Throw error if too many uuids are requested\n  if (nsecs >= 10000) {\n    throw new Error('uuid.v1(): Can\\'t create more than 10M uuids/sec');\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq;\n\n  // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n  msecs += 12219292800000;\n\n  // `time_low`\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff;\n\n  // `time_mid`\n  var tmh = (msecs / 0x100000000 * 10000) & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff;\n\n  // `time_high_and_version`\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n  b[i++] = tmh >>> 16 & 0xff;\n\n  // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n  b[i++] = clockseq >>> 8 | 0x80;\n\n  // `clock_seq_low`\n  b[i++] = clockseq & 0xff;\n\n  // `node`\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf ? buf : bytesToUuid(b);\n}\n\nmodule.exports = v1;\n","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof(options) == 'string') {\n    buf = options === 'binary' ? new Array(16) : null;\n    options = null;\n  }\n  options = options || {};\n\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = (rnds[6] & 0x0f) | 0x40;\n  rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nmodule.exports = v4;\n"],"sourceRoot":""}